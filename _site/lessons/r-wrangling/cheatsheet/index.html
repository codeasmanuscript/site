<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Cheatsheet: Data wrangling in R &middot; Code As Manuscript
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">

  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body class="theme-base-0d">

    <div class="sidebar">
  <div class="container"> <!--sidebar-sticky? I deleted it from here-->
    <div class="sidebar-about">
      <h2>
        <a href="">
          Code As Manuscript
        </a>
      </h2>
      <p class="lead">Writing your code and analyses as if <i>it</i> was the manuscript.</p>
    </div>

    <nav class="sidebar-nav">
      <a class="sidebar-nav-item" href="/">Home</a>

      

      
      
        
          
        
      
        
          
        
      
        
          
            
              <a class="sidebar-nav-item" href="/">About</a>
            
          
        
      
        
          
            
              <a class="sidebar-nav-item" href="/gps/">GPS</a>
            
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
      
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
            
              <a class="sidebar-nav-item" href="/lessons/">Lessons</a>
            
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      
        
          
        
      

      <a class="sidebar-nav-item" href="https://github.com/codeasmanuscript">GitHub</a>
    </nav>

    <p>&copy; 2015. All rights reserved.</p>
  </div>
</div>


    <div class="content container">
      <div class="page">
  <h1 class="page-title">Cheatsheet: Data wrangling in R</h1>
  <p>R is a statistical computing environment to analyze data and write programs. 
Getting the data into an analyzable form is the hardest part of an analysis. 
Here is a cheatsheet of useful and/or common commands.  For a more detailed
cheatsheet, <a href="../resources/">check out the resource page</a>.</p>

<h1 id="r-data-wrangling-commands-some-useful-or-common-ones">R data wrangling commands: Some useful or common ones</h1>

<h2 id="writecsv-or-writetable"><code>write.csv</code> or <code>write.table</code></h2>

<blockquote>
  <p>Save the R object or dataframe (aka. dataset) in a <code>.csv</code> file (comma
separated values).  Using <code>write.table</code>, you can export a number of different
file formats.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="c1">## Export</span>
write.csv<span class="p">(</span>swiss<span class="p">,</span> file <span class="o">=</span> <span class="s">&#39;swiss.csv&#39;</span><span class="p">)</span>

<span class="c1">## Which is the same as:</span>
write.table<span class="p">(</span>swiss<span class="p">,</span> file <span class="o">=</span> <span class="s">&#39;swiss.csv&#39;</span><span class="p">,</span> sep <span class="o">=</span> <span class="s">&#39;,&#39;</span><span class="p">)</span></code></pre></div>

<h2 id="readcsv-or-readtable"><code>read.csv</code> or <code>read.table</code></h2>

<blockquote>
  <p>Similar to <code>write.table</code>.  Imports a file (eg. <code>csv</code>).</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r">write.csv<span class="p">(</span>swiss<span class="p">,</span> file <span class="o">=</span> <span class="s">&#39;swiss.csv&#39;</span><span class="p">)</span>
read.csv<span class="p">(</span><span class="s">&#39;swiss.csv&#39;</span><span class="p">)</span></code></pre></div>

<h2 id="head-names-str-summary"><code>head</code>, <code>names</code>, <code>str</code>, <code>summary</code></h2>

<blockquote>
  <p>These four commands give you a brief overview of your dataframe or R object. 
<code>head</code> lets you see the first 6 rows. <code>names</code> lets you see the variable names in
the dataframe. <code>str</code> lets you see the structure of your R object/dataframe,
showing you what variables there are, and what the type is (eg. number, integer,
character, etc).  <code>summary</code> is very useful to get a quick overview of the mean,
median, frequency, and other basic statistics of each variable in the dataframe.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kp">head</span><span class="p">(</span>swiss<span class="p">)</span>
<span class="kp">names</span><span class="p">(</span>swiss<span class="p">)</span>
str<span class="p">(</span>swiss<span class="p">)</span>
<span class="kp">summary</span><span class="p">(</span>swiss<span class="p">)</span>
<span class="kp">class</span><span class="p">(</span>swiss<span class="p">)</span></code></pre></div>

<h2 id="section"><code>%&gt;%</code></h2>

<blockquote>
  <p>The pipe function is a general purpose, extremely powerful tool for making
your code easier to read and quicker to type out.  It takes the output from the
left hand side and puts it into the right hand command.  The <code>.</code> command tells
the pipe to use the output from the left hand side, which you sometimes have to
do for some functions/commands (like <code>lm()</code>).</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## This is the package that the pipe comes from</span>
<span class="kn">library</span><span class="p">(</span>magrittr<span class="p">)</span> 

<span class="c1">## These are the same</span>
<span class="kp">sum</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">10</span><span class="p">)</span>
<span class="m">1</span><span class="o">:</span><span class="m">10</span> <span class="o">%&gt;%</span> <span class="kp">sum</span>

<span class="c1">## These all do the same thing</span>
<span class="kp">head</span><span class="p">(</span>swiss<span class="p">)</span>
swiss <span class="o">%&gt;%</span> <span class="kp">head</span>
swiss <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">()</span>
swiss <span class="o">%&gt;%</span> <span class="kp">head</span><span class="p">(</span><span class="m">.</span><span class="p">)</span></code></pre></div>

<h2 id="tbldf"><code>tbl_df</code></h2>

<blockquote>
  <p>Sets the <code>tbl</code> attribute to the dataframe, which makes the printing of the
dataframe prettier.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
tbl_df<span class="p">(</span>ds<span class="p">)</span>
ds <span class="o">%&gt;%</span> tbl_df
ds <span class="o">%&gt;%</span> tbl_df<span class="p">()</span>
ds <span class="o">%&gt;%</span> tbl_df<span class="p">(</span><span class="m">.</span><span class="p">)</span></code></pre></div>

<h2 id="select"><code>select</code></h2>

<blockquote>
  <p>Get only the columns/variables you want from a dataframe.  You can select
variables based on pattern or if it contains some letter.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
select<span class="p">(</span>swiss<span class="p">,</span> Education<span class="p">,</span> Catholic<span class="p">,</span> Fertility<span class="p">)</span>
swiss <span class="o">%&gt;%</span> select<span class="p">(</span>Education<span class="p">,</span> Catholic<span class="p">,</span> Fertility<span class="p">)</span>
swiss <span class="o">%&gt;%</span> select<span class="p">(</span><span class="m">.</span><span class="p">,</span> Education<span class="p">,</span> Catholic<span class="p">,</span> Fertility<span class="p">)</span>

<span class="c1">## Exclude variable(s)</span>
swiss <span class="o">%&gt;%</span> select<span class="p">(</span><span class="o">-</span>Education<span class="p">,</span> <span class="o">-</span>Catholic<span class="p">)</span>

<span class="c1">## Select variables based on name or pattern</span>
swiss <span class="o">%&gt;%</span> select<span class="p">(</span>starts_with<span class="p">(</span><span class="s">&#39;E&#39;</span><span class="p">),</span> contains<span class="p">(</span><span class="s">&#39;Fert&#39;</span><span class="p">),</span> matches<span class="p">(</span><span class="s">&#39;mort&#39;</span><span class="p">))</span></code></pre></div>

<h2 id="rename"><code>rename</code></h2>

<blockquote>
  <p>Change the name of a variable/column.  The new name is on the left hand side,
so <code>newname = oldname</code>.  You can also rename using the <code>select</code> command, but it
will only select what variables you give it, while rename keeps the dataframe as
is, as it only renames.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
rename<span class="p">(</span>swiss<span class="p">,</span> edu <span class="o">=</span> Education<span class="p">)</span>
swiss <span class="o">%&gt;%</span> rename<span class="p">(</span>edu <span class="o">=</span> Education<span class="p">)</span>

<span class="c1">## Multiple renaming</span>
swiss <span class="o">%&gt;%</span> rename<span class="p">(</span>edu <span class="o">=</span> Education<span class="p">,</span> fert <span class="o">=</span> Fertility<span class="p">)</span>

<span class="c1">## If you want to use select, but get the same functionality as rename, use the</span>
<span class="c1">## everything() function to select all other variables in the dataframe</span>
swiss <span class="o">%&gt;%</span> select<span class="p">(</span>edu <span class="o">=</span> Education<span class="p">,</span> everything<span class="p">())</span></code></pre></div>

<h2 id="filter"><code>filter</code></h2>

<blockquote>
  <p>Subset a dataframe based on a condition of a variable. Filtering splits the
dataframe by the value of the row.  Common conditions include <code>&lt;</code> less than, <code>&gt;</code>
greater than, <code>==</code> equals, <code>&gt;=</code> or <code>&lt;=</code> greater/less than or equal to.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
filter<span class="p">(</span>swiss<span class="p">,</span> Catholic <span class="o">&lt;</span> <span class="m">20</span><span class="p">,</span> Examination <span class="o">==</span> <span class="m">15</span><span class="p">)</span>
swiss <span class="o">%&gt;%</span> filter<span class="p">(</span>Catholic <span class="o">&lt;</span> <span class="m">20</span><span class="p">,</span> Examination <span class="o">==</span> <span class="m">15</span><span class="p">)</span>
swiss <span class="o">%&gt;%</span> filter<span class="p">(</span><span class="m">.</span><span class="p">,</span> Catholic <span class="o">&lt;</span> <span class="m">20</span><span class="p">,</span> Examination <span class="o">==</span> <span class="m">15</span><span class="p">)</span>

<span class="c1">## For string/factor variables</span>
swiss <span class="o">%&gt;%</span> filter<span class="p">(</span>X <span class="o">==</span> <span class="s">&#39;Aigle&#39;</span><span class="p">)</span></code></pre></div>

<h2 id="mutate"><code>mutate</code></h2>

<blockquote>
  <p>Create a new column.  A command that may be used is the <code>ifelse()</code> function
that assigns a value based on the condition.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
mutate<span class="p">(</span>swiss<span class="p">,</span> Infertile <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Fertility <span class="o">&lt;</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">))</span>
swiss <span class="o">%&gt;%</span> mutate<span class="p">(</span>Infertile <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Fertility <span class="o">&lt;</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">))</span>
swiss <span class="o">%&gt;%</span> mutate<span class="p">(</span><span class="m">.</span><span class="p">,</span> Infertile <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Fertility <span class="o">&lt;</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">))</span>

<span class="c1">## Or..</span>
swiss <span class="o">%&gt;%</span> mutate<span class="p">(</span>Test <span class="o">=</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> Number <span class="o">=</span> <span class="m">10</span><span class="p">)</span></code></pre></div>

<h2 id="arrange"><code>arrange</code></h2>

<blockquote>
  <p>Sort/order a dataframe by a variable.  Sort by the order of the variables
given (eg. <code>arrange(var1, var2)</code> sorts first by <code>var1</code> than by <code>var2</code>).</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="c1">## These are the same</span>
arrange<span class="p">(</span>swiss<span class="p">,</span> Education<span class="p">,</span> Examination<span class="p">)</span>
swiss <span class="o">%&gt;%</span> arrange<span class="p">(</span>Education<span class="p">,</span> Examination<span class="p">)</span>
swiss <span class="o">%&gt;%</span> arrange<span class="p">(</span><span class="m">.</span><span class="p">,</span> Education<span class="p">,</span> Examination<span class="p">)</span>

<span class="c1">## Or to do it descending</span>
swiss <span class="o">%&gt;%</span> arrange<span class="p">(</span>desc<span class="p">(</span>Education<span class="p">))</span></code></pre></div>

<h2 id="groupby"><code>group_by</code></h2>

<blockquote>
  <p>Assigns the attribute <code>grouped_df</code> to the dataframe, which on it’s own does
nothing but when used in conjunction with <code>summarise</code> or <code>mutate</code> does the
following commands based on the grouping.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
swiss <span class="o">%&gt;%</span>
    mutate<span class="p">(</span>EarlyDeath <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Infant.Mortality <span class="o">&gt;=</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>EarlyDeath<span class="p">)</span></code></pre></div>

<h2 id="summarise"><code>summarise</code></h2>

<blockquote>
  <p>Create a new column of values, usually using a descriptive statistic function
such as <code>mean()</code> or <code>median()</code>, as well as informational functions like <code>n()</code>
for sample size.  This function is best used with <code>group_by()</code>.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
swiss <span class="o">%&gt;%</span>
    mutate<span class="p">(</span>Educated <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Education <span class="o">&gt;=</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span>
    group_by<span class="p">(</span>Educated<span class="p">)</span> <span class="o">%&gt;%</span>
    str<span class="p">()</span>
    summarise<span class="p">(</span>mean <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>Agriculture<span class="p">))</span></code></pre></div>

<h2 id="gather"><code>gather</code></h2>

<blockquote>
  <p>Convert a wide dataframe to a long dataframe.  This creates a dataframe with
at least two new variables, one containing the names of the original variables
and the other containing the values of the variables.  You can include or
exclude certain variables by selecting the variable you want to include or
exclude (with a <code>-</code>) after the name of the two new variables.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
<span class="c1">## These are the same</span>
gather<span class="p">(</span>swiss<span class="p">,</span> Measure<span class="p">,</span> Value<span class="p">)</span>
swiss <span class="o">%&gt;%</span> gather<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">)</span>
swiss <span class="o">%&gt;%</span> gather<span class="p">(</span><span class="m">.</span><span class="p">,</span> Measure<span class="p">,</span> Value<span class="p">)</span>

<span class="c1">## Or exclude certain variables</span>
swiss <span class="o">%&gt;%</span> add_rownames<span class="p">()</span> <span class="o">%&gt;%</span> gather<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">,</span> <span class="o">-</span>rowname<span class="p">)</span>

<span class="c1">## Or include only some variables</span>
swiss <span class="o">%&gt;%</span> gather<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">,</span> Education<span class="p">,</span> Fertility<span class="p">,</span> Infant.Mortality<span class="p">)</span></code></pre></div>

<h2 id="spread"><code>spread</code></h2>

<blockquote>
  <p>Does the opposite of <code>gather</code> by converting long dataframes to wide
dataframes.</p>
</blockquote>

<blockquote>
  <p>Example code:</p>
</blockquote>

<div class="highlight"><pre><code class="language-r" data-lang="r"><span class="kn">library</span><span class="p">(</span>dplyr<span class="p">)</span>
<span class="kn">library</span><span class="p">(</span>tidyr<span class="p">)</span>
swiss <span class="o">%&gt;%</span> 
    add_rownames<span class="p">()</span> <span class="o">%&gt;%</span> 
    gather<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">,</span> <span class="o">-</span>rowname<span class="p">)</span> <span class="o">%&gt;%</span> 
    spread<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">)</span></code></pre></div>

<h1 id="combined-example-using-almost-all-functions">Combined example using (almost) all functions:</h1>

<div class="highlight"><pre><code class="language-r" data-lang="r">swiss <span class="o">%&gt;%</span>
    add_rownames<span class="p">()</span> <span class="o">%&gt;%</span> 
    tbl_df<span class="p">()</span> <span class="o">%&gt;%</span> 
    filter<span class="p">(</span>Infant.Mortality <span class="o">&gt;=</span> <span class="m">15</span><span class="p">)</span> <span class="o">%&gt;%</span> 
    mutate<span class="p">(</span>Religious <span class="o">=</span> <span class="kp">ifelse</span><span class="p">(</span>Catholic <span class="o">&lt;=</span> <span class="m">50</span><span class="p">,</span> <span class="s">&#39;no&#39;</span><span class="p">,</span> <span class="s">&#39;yes&#39;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
    select<span class="p">(</span>Education<span class="p">,</span> Agriculture<span class="p">,</span> Examination<span class="p">,</span> Religious<span class="p">)</span> <span class="o">%&gt;%</span>
    gather<span class="p">(</span>Measure<span class="p">,</span> Value<span class="p">,</span> <span class="o">-</span>Religious<span class="p">)</span> <span class="o">%&gt;%</span> 
    group_by<span class="p">(</span>Measure<span class="p">,</span> Religious<span class="p">)</span> <span class="o">%&gt;%</span> 
    summarise<span class="p">(</span>mean <span class="o">=</span> <span class="kp">mean</span><span class="p">(</span>Value<span class="p">))</span> <span class="o">%&gt;%</span>
    spread<span class="p">(</span>Measure<span class="p">,</span> <span class="kp">mean</span><span class="p">)</span></code></pre></div>


</div>

    </div>

  </body>
</html>
